<div class="insertar-personaje">
  <p-button
    id="btnInsertarPersonaje"
    label="Insertar Nuevo Personaje"
    icon="pi pi-plus-circle"
    (onClick)="insertar()"
  >
  </p-button>
</div>

<div class="tabla-contenedor">
  @if (listaDePersonajes().length > 0) {
    <p-table 
      [value]="listaDePersonajes()" 
      [paginator]="true" 
      [rows]="5" 
      border="1">
      
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="nombre">
            Nombre <p-sortIcon field="nombre"></p-sortIcon>
          </th>
          <th pSortableColumn="raza">
            Raza <p-sortIcon field="raza"></p-sortIcon>
          </th>
          <th pSortableColumn="fechaNacimiento">
            Fecha de Nacimiento <p-sortIcon field="fechaNacimiento"></p-sortIcon>
          </th>
          <th pSortableColumn="nivelCorrupcion">
            Corrupción <p-sortIcon field="nivelCorrupcion"></p-sortIcon>
          </th>
          <th>Edición</th>
          <th>Baja Física</th>
          <th>Baja Lógica</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-personaje>
        <tr>
          <td>{{ personaje.nombre }}</td>
          <td>{{ personaje.raza }}</td>
          <td>{{ personaje.fechaNacimiento }}</td>
          <td>{{ personaje.nivelCorrupcion }}%</td>

          <td>
            <p-button
              label="Editar"
              icon="pi pi-pencil"
              [outlined]="true"
              (onClick)="editar(personaje.id)"
            />
          </td>

          <td>
            <p-button
              label="Baja Física"
              icon="pi pi-trash"
              severity="danger"
              [outlined]="true"
              (onClick)="prepararBajaFisica(personaje, $event)"
            />
          </td>

          <td>
            @if (!personaje.fechaBaja) {
              <p-button
                label="Baja Lógica"
                icon="pi pi-user-minus"
                severity="warn"
                [outlined]="true"
                (onClick)="prepararBajaLogica(personaje, $event)"
              />
            } @else {
              <p-button
                label="Reactivar"
                icon="pi pi-refresh"
                severity="success"
                [outlined]="true"
                (onClick)="prepararReactivacion(personaje, $event)"
              />
            }
          </td>
        </tr>
      </ng-template>
    </p-table>
  } @else {
    <p>No se han encontrado personajes...</p>
  }
</div>

<app-confirmar-popup [config]="configuracionHijo"></app-confirmar-popup>